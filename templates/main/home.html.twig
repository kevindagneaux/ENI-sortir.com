{% extends 'base.html.twig' %}

{% block body %}
   <div id="front">
       <h4>Date du jour: {{ "now" |date('d-m-y') }}</h4>
       <h4>Participant: Micheline.M{# {{ app.user.pseudo }} #}</h4>
   </div>
    <h3>Filtrer les sorties :</h3>
    <div>
        {{ form_start(searchSortie) }}
        {{ form_widget(searchSortie) }}

        <button type="submit">Rechercher</button>
        {{ form_end(searchSortie) }}

    </div>
    <div>
        <table>
            <thead>
                <tr>
                    <th>Nom de la sortie</th>
                    <th>Date de la sortie</th>
                    <th>Clôture</th>
                    <th>inscrit/places</th>
                    <th>Etat</th>
                    <th>inscrit</th>
                    <th>Organisateur</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
            {% for sortie in sorties %}
                <tr>
                    <td>{{ sortie.nom }}</td>
                    <td>{{ sortie.dateHeureDebut| date('d/M/Y h:m') }}</td>
                    <td>{{ sortie.dateLimiteInscription| date('d/M/Y') }}</td>
                    <td>
                        {% if sortie.users != null %}
                            {{ sortie.users | length }}
                        {% else %}
                            0
                        {% endif %}
                        /{{ sortie.nbInscriptionMax }}
                    </td>
                    <td>{{ sortie.etat.libelle }}</td>
                    <td>{{ app.user in sortie.users ?'x' :' '}}</td>
                    <td>{{ sortie.organisateur.pseudo }}</td>
                    <td>
                        {% if app.user != sortie.organisateur %}
                                <a href="#">Afficher</a>
                            {% if app.user not in sortie.users %}
                                <a href="{{ path('inscription', {'id': sortie.id})}}">S'inscrire</a>
                            {% else %}
                                <a href="{{ path('desistement', {'id': sortie.id})}}">Se desinscrire</a>
                            {% endif %}
                        {% else %}
                            <a href="#">Modifier</a>
                            <a href="#">Publier</a>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <div>
        <button><a href="{{ path('sortie_ajouter')}}">Créer Sortie</a></button>
    </div>
{% endblock %}

{% block title %} {{ parent() }} | Accueil {% endblock %}
